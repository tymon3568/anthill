{
  "db_name": "PostgreSQL",
  "query": "\n            WITH RECURSIVE ancestor_chain AS (\n                -- Base case: start with the given warehouse\n                SELECT warehouse_id, parent_warehouse_id, 0 AS depth\n                FROM warehouses\n                WHERE tenant_id = $1 AND warehouse_id = $2 AND deleted_at IS NULL\n\n                UNION ALL\n\n                -- Recursive case: step up to the parent\n                SELECT w.warehouse_id, w.parent_warehouse_id, ac.depth + 1\n                FROM warehouses w\n                INNER JOIN ancestor_chain ac ON w.warehouse_id = ac.parent_warehouse_id\n                WHERE w.tenant_id = $1 AND w.deleted_at IS NULL\n            )\n            SELECT warehouse_id\n            FROM ancestor_chain\n            WHERE depth > 0  -- Exclude the original warehouse, only return ancestors\n            ORDER BY depth DESC  -- Root first, then immediate parent\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "warehouse_id",
        "type_info": "Uuid"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid",
        "Uuid"
      ]
    },
    "nullable": [
      null
    ]
  },
  "hash": "b9451c2168e0a255d392c564e069962adf40b7a7d93144edea91b20cf8433fd8"
}
