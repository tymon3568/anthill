# Svelte 5 Development Guidelines

## üö® CRITICAL: Always Use Svelte MCP and Svelte 5 Runes

**ALL Svelte/SvelteKit development MUST follow these rules:**

### üîç **Before Any Svelte Code Changes:**

1. **ALWAYS** call `mcp_svelte_list-sections` first to see available documentation
2. **ALWAYS** call `mcp_svelte_get-documentation` with relevant sections before implementing
3. **NEVER** implement Svelte code without consulting current Svelte 5 documentation

### üèóÔ∏è **Svelte 5 Runes Usage (MANDATORY):**

#### State Management

```typescript
// ‚úÖ CORRECT: Use $state rune
export const userState = $state<User | null>(null);
export const isLoading = $state(false);

// ‚ùå WRONG: Never use legacy stores
// const userStore = writable<User | null>(null);
```

#### Reactive Statements

```svelte
<script>
	let count = $state(0);
	let doubled = $derived(count * 2);

	// ‚úÖ CORRECT: Use $effect for side effects
	$effect(() => {
		console.log('Count changed:', count);
	});

	// ‚ùå WRONG: Never use reactive statements
	// $: console.log('Count changed:', count);
	// $: doubled = count * 2;
</script>
```

#### Component Props

```svelte
<script>
	// ‚úÖ CORRECT: Use $props rune
	let { title, items = $bindable() } = $props<{
		title: string;
		items?: string[];
	}>();

	// ‚ùå WRONG: Never use export let
	// export let title: string;
	// export let items: string[] = [];
</script>
```

#### Template Syntax

```svelte
<!-- ‚úÖ CORRECT: Use {@render ...} -->
{@render children()}

<!-- ‚ùå WRONG: Never use <slot /> -->
<!-- <slot /> -->
```

### üìö **Documentation Lookup Process:**

1. **Identify the task** (e.g., "implement form validation")
2. **Call `mcp_svelte_list-sections`** to see all available docs
3. **Analyze use_cases** to find relevant sections
4. **Call `mcp_svelte_get-documentation`** with ALL relevant sections
5. **Read and understand** the documentation thoroughly
6. **Implement using** the documented patterns

### üîÑ **Migration Checklist:**

When working with existing code:

- [ ] Replace `writable()` stores with `$state`
- [ ] Replace `$store` syntax with direct state access
- [ ] Replace `$:` reactive statements with `$effect` or `$derived`
- [ ] Replace `export let` with `$props`
- [ ] Replace `<slot />` with `{@render children()}`
- [ ] Remove `import { writable } from 'svelte/store'`

### üõ†Ô∏è **Tools to Use:**

- `mcp_svelte_list-sections` - List all available documentation
- `mcp_svelte_get-documentation` - Get specific documentation sections
- `mcp_svelte_svelte-autofixer` - Fix Svelte code issues
- `mcp_svelte_playground-link` - Create playground links for testing

### ‚ö†Ô∏è **Red Flags (DO NOT DO):**

- Using `writable()`, `readable()`, `derived()` from `svelte/store`
- Using `$storeName` syntax in templates
- Using `$:` reactive statements
- Using `export let` for props
- Using `<slot />` in templates
- Implementing without checking documentation first

### üìã **Implementation Steps:**

1. **Read the task** and understand requirements
2. **Call `mcp_svelte_list-sections`** to explore docs
3. **Identify relevant sections** from use_cases
4. **Call `mcp_svelte_get-documentation`** with selected sections
5. **Study the documentation** carefully
6. **Implement using Svelte 5 patterns**
7. **Run `mcp_svelte_svelte-autofixer`** to validate code
8. **Test the implementation**

### üéØ **Quality Assurance:**

After implementation:

- Run `bun run build` to ensure compilation
- Run `bun run lint` for code quality
- Run `bun run test` for functionality
- Use `mcp_svelte_svelte-autofixer` to check for issues

---

# üé® UI Design Guidelines - Frappe UI Style

## **MANDATORY: All shadcn-svelte components MUST follow Frappe UI design principles**

### **Frappe UI Philosophy:**

Frappe UI emphasizes **clean, minimal, professional** design with:

- ‚úÖ **Minimal shadows** - Remove most shadow effects for cleaner look
- ‚úÖ **Simple rounded corners** - Use `rounded` or `rounded-lg`, avoid `rounded-xl`
- ‚úÖ **Gray-based color scheme** - Prefer simple grays over complex color systems
- ‚úÖ **Clean focus states** - Simple border changes, no complex rings
- ‚úÖ **Compact spacing** - Reduce padding and margins for tighter layouts

### **Component Styling Rules:**

#### **Buttons:**

```typescript
// ‚úÖ CORRECT: Frappe UI style
buttonVariants = tv({
	base: "inline-flex shrink-0 items-center justify-center gap-2 whitespace-nowrap text-sm font-medium outline-none transition-colors disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none [&_svg]:shrink-0 border border-transparent focus-visible:border-gray-300 focus-visible:outline-none",
	variants: {
		variant: {
			default: 'bg-gray-900 text-white hover:bg-gray-800',
			destructive: 'bg-red-600 text-white hover:bg-red-700',
			outline: 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50',
			secondary: 'bg-gray-100 text-gray-900 hover:bg-gray-200',
			ghost: 'text-gray-700 hover:bg-gray-100',
			link: 'text-blue-600 underline-offset-4 hover:underline'
		},
		size: {
			default: 'h-8 px-3 py-1.5',
			sm: 'h-7 gap-1.5 px-2.5 py-1 text-xs',
			lg: 'h-9 px-4 py-2 text-base',
			icon: 'size-8',
			'icon-sm': 'size-7',
			'icon-lg': 'size-9'
		}
	}
});

// ‚ùå WRONG: Avoid shadcn default style
// shadow-xs, rounded-md, complex focus rings, OKLCH colors
```

#### **Inputs:**

```typescript
// ‚úÖ CORRECT: Frappe UI style
class={cn(
  'flex h-8 w-full min-w-0 rounded border border-gray-300 bg-white px-3 py-1.5 text-sm outline-none placeholder:text-gray-500 disabled:cursor-not-allowed disabled:opacity-50',
  'focus:border-gray-500 focus:outline-none',
  'aria-invalid:border-red-500',
  className
)}

// ‚ùå WRONG: Avoid complex styling
// shadow-xs, complex ring system, OKLCH colors
```

#### **Cards:**

```typescript
// ‚úÖ CORRECT: Frappe UI style
class={cn(
  'flex flex-col gap-4 rounded-lg border border-gray-200 bg-white p-4 text-gray-900',
  className
)}

// ‚ùå WRONG: Avoid heavy styling
// rounded-xl, shadow-sm, complex spacing
```

#### **CSS Variables:**

```css
/* ‚úÖ CORRECT: Simple hex colors */
:root {
	--radius: 0.375rem;
	--background: #ffffff;
	--foreground: #1f2937;
	--primary: #1f2937;
	--border: #e5e7eb;
	--destructive: #dc2626;
}

/* ‚ùå WRONG: Avoid complex color systems */
/* OKLCH colors, large radius (0.625rem) */
```

### **Design Research Process:**

1. **Study Frappe UI** - Use Context7 to research `/frappe/frappe-ui` documentation
2. **Analyze components** - Compare with current shadcn-svelte implementations
3. **Apply minimal changes** - Focus on removing complexity, not adding features
4. **Test consistency** - Ensure all components follow the same design language

### **Tools for UI Research:**

- **Context7**: `resolve-library-id` and `get-library-docs` for Frappe UI research
- **Frappe UI Website**: https://ui.frappe.io/ for visual reference
- **Component Comparison**: Side-by-side testing of old vs new styles

### **Quality Checklist:**

- [ ] All shadows removed or minimized
- [ ] Rounded corners consistent (rounded-lg max)
- [ ] Color scheme uses simple grays
- [ ] Focus states are clean and minimal
- [ ] Spacing is compact and consistent
- [ ] Components look professional and clean

### **Migration Steps:**

1. **Update CSS variables** - Replace OKLCH with hex colors, reduce radius
2. **Modify button variants** - Remove shadows, simplify colors, reduce padding
3. **Update input styling** - Remove shadows, simplify focus states
4. **Simplify card design** - Remove shadows, reduce rounded corners
5. **Update dialog/modal** - Remove shadows, use minimal styling
6. **Test all components** - Ensure consistency across the application

---

**REMEMBER: Svelte 5 runes are the ONLY acceptable way to write Svelte code in this project. Always consult MCP documentation first!**

# Agent & Contributor Instructions ‚Äî ALWAYS Use Bun

**CRITICAL: This repository REQUIRES bun for all frontend development operations.**

This is NOT optional - bun must be used for package management, running scripts, and executing CLI tools.

## Why Bun is Mandatory

- **Performance**: 10-20x faster installs compared to npm/pnpm
- **All-in-one tooling**: Single binary replaces npm + npx + node
- **Native TypeScript**: Direct `.ts` execution without transpilation
- **Optimized for Vite/Svelte**: Better HMR performance and build times
- **Compatibility**: Drop-in replacement for npm with better caching

## Strict Guidelines for Agents and Contributors

### 1. **Package Management - ALWAYS use `bun`**

```zsh
# Install dependencies
bun install

# Add new packages
bun add <package>
bun add --dev <package>

# Update packages
bun update <package>

# Remove packages
bun remove <package>
```

**‚ùå NEVER use:** `npm install`, `npm add`, `pnpm add`
**‚úÖ ALWAYS use:** `bun install`, `bun add`

### 2. **Running Scripts - ALWAYS use `bun run`**

```zsh
# Development server
bun run dev

# Type checking
bun run check

# Build production
bun run build

# Run tests
bun run test:unit
bun run test:e2e
bun run test
```

**‚ùå NEVER use:** `npm run dev`, `npm run build`
**‚úÖ ALWAYS use:** `bun run dev`, `bun run build`

### 3. **CLI Tools - ALWAYS use `bunx`**

```zsh
# Run Playwright
bunx playwright test

# Run Vitest directly
bunx vitest

# Any other CLI tool
bunx <command>
```

**‚ùå NEVER use:** `npx`, `pnpm dlx`
**‚úÖ ALWAYS use:** `bunx`

### 4. **Shell Environment**

- Default shell: `zsh`
- Use absolute paths when necessary
- All commands assume bun is installed globally

### 5. **Git Commit Messages**

Reference task IDs from `PROJECT_TRACKING`:

```
feat(auth): complete authentication UI [TaskID: 08.02.01]
fix(api): handle cookie-based refresh tokens [TaskID: 08.02.03]
```

### 6. **Quality Assurance Commands**

Run these before committing:

```zsh
# Type checking + linting
bun run check

# Unit tests
bun run test:unit

# E2E tests
bun run test:e2e

# Format code
bun run format

# Build verification
bun run build
```

## Critical Rules for AI Agents

1. **NEVER suggest or use npm/pnpm/npx commands** - Always convert to bun equivalents
2. **When reading package.json scripts** - Execute with `bun run <script>`
3. **For any CLI tool** - Use `bunx <tool>` instead of `npx <tool>`
4. **Installation commands** - Always use `bun install` or `bun add`
5. **If a command fails** - Check if the script exists in package.json, then use `bunx` as fallback

## Troubleshooting

**Script not found:**

```zsh
# Check package.json scripts first
cat package.json | grep -A 20 '"scripts"'

# If not in scripts, use bunx
bunx vite dev
```

**Module not found:**

```zsh
# Always reinstall with bun
bun install
```

**Permission issues:**

```zsh
# Bun doesn't need sudo for global installs
bun install -g <package>
```

---

**This file sets strict requirements: ALL frontend operations MUST use bun. No exceptions.**
